<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<style>
  body { margin:0; padding:16px; background:#111; color:#eee; font-family:system-ui,sans-serif; }
  h1 { margin:0 0 12px; font-size:18px; }
  .row { display:flex; gap:12px; flex-wrap:wrap; align-items:baseline; }
  .grid { display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-top:12px; }
  .control { background:#161616; border:1px solid #2a2a2a; border-radius:10px; padding:10px; }
  .control label { display:block; font-size:11px; opacity:0.75; margin-bottom:6px; }
  .control input[type=range] { width:100%; }
  .pill { font-size:11px; opacity:0.7; margin-left:auto; }
</style>
</head>
<body>
  <div class="row">
    <h1>SHEAR | Amp</h1>
    <div class="pill">Amp head → Cab IR → Output</div>
  </div>

  <div class="grid">
    <div class="control"><label>Input (dB)</label><input type="range" min="-24" max="24" step="0.1" data-p="input"></div>
    <div class="control"><label>Gain</label><input type="range" min="0" max="1" step="0.001" data-p="gain"></div>
    <div class="control"><label>Model (0=Clean,1=Crunch,2=HiGain)</label><input type="range" min="0" max="2" step="1" data-p="model"></div>
    <div class="control"><label>Oversample (0=Off,1=2x)</label><input type="range" min="0" max="1" step="1" data-p="os"></div>
    <div class="control"><label>Bass (dB)</label><input type="range" min="-12" max="12" step="0.1" data-p="bass"></div>
    <div class="control"><label>Mid (dB)</label><input type="range" min="-12" max="12" step="0.1" data-p="mid"></div>
    <div class="control"><label>Treble (dB)</label><input type="range" min="-12" max="12" step="0.1" data-p="treble"></div>
    <div class="control"><label>Presence</label><input type="range" min="0" max="1" step="0.001" data-p="presence"></div>
    <div class="control"><label>Noise Gate (dB)</label><input type="range" min="-80" max="0" step="1" data-p="gate"></div>
    <div class="control"><label>Master</label><input type="range" min="0" max="1" step="0.001" data-p="master"></div>

    <div class="control"><label>Cab (0=1x12,1=2x12,2=4x12)</label><input type="range" min="0" max="2" step="1" data-p="cab"></div>
    <div class="control"><label>Mic (0=Dyn,1=Cond,2=Ribbon)</label><input type="range" min="0" max="2" step="1" data-p="mic"></div>
    <div class="control"><label>Air/Room</label><input type="range" min="0" max="1" step="0.01" data-p="air"></div>
    <div class="control"><label>Cab Mix</label><input type="range" min="0" max="1" step="0.01" data-p="cabMix"></div>
  </div>

<script>
  const controls = document.querySelectorAll("[data-p]");
  controls.forEach(c => {
    c.addEventListener("input", e => {
      parent.postMessage({ type: "setParam", paramId: c.dataset.p, value: Number(e.target.value) }, "*");
    });
  });

  window.addEventListener("message", e => {
    const msg = e.data;
    if (msg?.type === "init" || msg?.type === "state") {
      const p = msg?.state?.params || {};
      controls.forEach(c => {
        const v = p[c.dataset.p];
        if (v !== undefined) c.value = v;
      });
    }
  });

  parent.postMessage({ type: "requestState" }, "*");
</script>
</body>
</html>
